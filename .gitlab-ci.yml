stages:
  - install
  - triggers

install_deps:
  tags:
    - kube-build
  stage: install
  image: reg.1cb.kz/dockerhub/library/node:16.17.1-alpine3.15
  artifacts:
    paths:
      - node_modules
      - packages/main/build
    expire_in: 15 minute
  script:
    - npm i
    - ls packages/main

trigger_main:
  stage: triggers
  trigger:
    include: packages/main/.gitlab-ci.yml
  only:
    changes:
      - "packages/main/**/*"
    refs:
      - /lerna^/
#  script:
#    - ls -a
#    - cat node_modules
#    - cat packages/main/build
#  needs:
#    - project: packages/main/
#      job: install_deps
#      ref: /lerna^/
#      artifacts: true
