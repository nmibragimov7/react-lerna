stages:
  - install
  - triggers

install_deps:
  tags:
    - kube-build
  stage: install
  image: reg.1cb.kz/dockerhub/library/node:16.17.1-alpine3.15
  artifacts:
    paths:
      - node_modules
    expire_in: 15 minute
  script:
    - npm i

trigger_main:
  stage: triggers
  trigger:
    include: packages/main/.gitlab-ci.yml
  only:
    changes:
      - "packages/main/**/*"
    refs:
      - lerna

trigger_client:
  stage: triggers
  trigger:
    include: packages/client/.gitlab-ci.yml
  only:
    changes:
      - "packages/client/**/*"
    refs:
      - lerna
